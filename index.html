<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TrackPro</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:#0b0b0f;
  color:white;
}

/* HEADER */
.header{
  padding:18px;
  font-size:26px;
  font-weight:700;
  text-align:center;
  background:linear-gradient(90deg,#ff003c,#ff8c00);
}

/* PROFILE GRID */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(120px,1fr));
  gap:18px;
  padding:20px;
}

.profile{
  background:#15151c;
  border-radius:18px;
  height:140px;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  cursor:pointer;
  box-shadow:0 0 18px rgba(255,0,60,.2);
  transition:.2s;
}

.profile:hover{transform:scale(1.05);}

.addBox{
  font-size:40px;
  color:#ff8c00;
}

.name{
  margin-top:10px;
  font-weight:600;
}

/* DASHBOARD */
.container{padding:18px; max-width:900px; margin:auto;}

.card{
  background:#15151c;
  padding:18px;
  border-radius:18px;
  margin-bottom:16px;
}

button{
  background:linear-gradient(90deg,#ff003c,#ff8c00);
  border:none;
  padding:10px 16px;
  border-radius:12px;
  font-weight:700;
  cursor:pointer;
  margin:5px;
}

input,select{
  width:100%;
  padding:10px;
  margin:6px 0;
  border-radius:10px;
  border:none;
  background:#0b0b0f;
  color:white;
}

.hidden{display:none;}
.pr{color:#22c55e;font-weight:bold;}
</style>
</head>

<body>

<div class="header">üèÉ TrackPro</div>

<!-- PROFILE PAGE -->
<div id="profilesPage" class="grid"></div>

<!-- ATHLETE DASHBOARD -->
<div id="dashboard" class="hidden">

<div class="container">

<button onclick="back()">‚¨Ö Profiles</button>
<button onclick="deleteAthlete()">üóë Delete Athlete</button>

<div class="card">
<h2 id="athleteName"></h2>

<select id="event">
<option>100m</option>
<option>200m</option>
<option>400m</option>
<option>800m</option>
<option>1600m</option>
<option>Long Jump</option>
<option>High Jump</option>
<option>Triple Jump</option>
</select>

<input id="value" placeholder="Time (sec) or Distance">
<button onclick="addResult()">Add Result</button>

<div id="prNotice"></div>

<canvas id="chart"></canvas>
</div>

<div class="card">
<h3>üèÅ Race Prediction</h3>
<input id="predInput" placeholder="Recent time">
<button onclick="predict()">Predict</button>
<div id="prediction"></div>
</div>

<div class="card">
<h3>üéØ Goals</h3>
<input id="goalInput" placeholder="Goal">
<button onclick="addGoal()">Add</button>
<div id="goals"></div>
</div>

</div>
</div>

<script>
let data = JSON.parse(localStorage.getItem("trackUltra")) || {athletes:[]};
let current=null;

function save(){localStorage.setItem("trackUltra",JSON.stringify(data));}

/* PROFILE GRID */

function renderProfiles(){
  const grid=document.getElementById("profilesPage");
  grid.innerHTML="";

  data.athletes.forEach((a,i)=>{
    grid.innerHTML+=`
      <div class="profile" onclick="openAthlete(${i})">
        <div style="font-size:32px">üèÉ</div>
        <div class="name">${a.name}</div>
      </div>`;
  });

  grid.innerHTML+=`
    <div class="profile" onclick="addAthlete()">
      <div class="addBox">+</div>
    </div>`;
}

function addAthlete(){
  const name=prompt("Athlete name:");
  if(!name) return;

  data.athletes.push({name,results:{},goals:[]});
  save();
  renderProfiles();
}

/* DASHBOARD */

function openAthlete(i){
  current=i;
  athleteName.innerText=data.athletes[i].name;
  profilesPage.classList.add("hidden");
  dashboard.classList.remove("hidden");
  updateChart();
  renderGoals();
}

function back(){
  dashboard.classList.add("hidden");
  profilesPage.classList.remove("hidden");
}

function deleteAthlete(){
  if(confirm("Delete this athlete?")){
    data.athletes.splice(current,1);
    save();
    back();
    renderProfiles();
  }
}

/* RESULTS + PR DETECTION */

function addResult(){
  const e=event.value;
  const v=parseFloat(value.value);
  const a=data.athletes[current];

  if(!a.results[e]) a.results[e]=[];

  const best=Math.min(...a.results[e], Infinity);
  a.results[e].push(v);

  save();

  if(v < best){
    prNotice.innerHTML="üî• NEW PR!";
    prNotice.className="pr";
  } else prNotice.innerHTML="";

  updateChart();
}

let chart;

function updateChart(){
  const a=data.athletes[current];
  const e=event.value;
  const arr=a.results[e] || [];

  if(chart) chart.destroy();

  chart=new Chart(chart,{
    type:"line",
    data:{
      labels:arr.map((_,i)=>i+1),
      datasets:[{data:arr,borderColor:"#ff8c00"}]
    },
    options:{plugins:{legend:{display:false}}}
  });
}

/* PREDICTION */

function predict(){
  const t=parseFloat(predInput.value);
  prediction.innerText="Predicted PR: "+(t*0.97).toFixed(2);
}

/* GOALS */

function addGoal(){
  const a=data.athletes[current];
  a.goals.push(goalInput.value);
  save();
  renderGoals();
}

function renderGoals(){
  const a=data.athletes[current];
  goals.innerHTML=(a.goals||[]).map(g=>`<div>${g}</div>`).join("");
}

renderProfiles();
</script>

</body>
</html>
