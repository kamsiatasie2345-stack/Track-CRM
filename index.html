<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TrackPro Athlete</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:#0b0b0f;
  color:white;
}

.header{
  padding:18px;
  font-size:26px;
  font-weight:700;
  background:linear-gradient(90deg,#ff003c,#ff8c00);
  text-align:center;
}

.nav{
  display:flex;
  justify-content:space-around;
  background:#111;
  padding:10px 0;
}

.nav button{
  background:none;
  border:none;
  color:white;
  font-weight:600;
  font-size:16px;
  cursor:pointer;
}

.container{
  padding:18px;
  max-width:1100px;
  margin:auto;
}

.card{
  background:#15151c;
  padding:18px;
  border-radius:18px;
  margin-bottom:16px;
  box-shadow:0 0 20px rgba(255,0,60,.15);
}

input,select,textarea{
  width:100%;
  padding:12px;
  margin:6px 0;
  border-radius:10px;
  border:none;
  background:#0b0b0f;
  color:white;
}

button.primary{
  background:linear-gradient(90deg,#ff003c,#ff8c00);
  border:none;
  padding:12px;
  border-radius:12px;
  font-weight:700;
  cursor:pointer;
}

.profile{
  display:flex;
  gap:12px;
  align-items:center;
  background:#0b0b0f;
  padding:10px;
  border-radius:12px;
  margin-bottom:8px;
  cursor:pointer;
}

.avatar{
  width:60px;
  height:60px;
  border-radius:50%;
  object-fit:cover;
  background:#222;
}

.hidden{display:none;}
.goal{background:#0b0b0f;padding:8px;border-radius:10px;margin-top:6px;}
</style>
</head>

<body>

<div class="header">üèÉ TrackPro Athlete</div>

<div class="nav hidden" id="nav">
  <button onclick="showPage('profiles')">Profiles</button>
  <button onclick="showPage('stats')">Stats</button>
  <button onclick="showPage('workout')">Workout</button>
  <button onclick="showPage('sync')">Sync</button>
</div>

<div class="container">

<!-- PROFILES PAGE -->
<div id="profilesPage">

<div class="card">
<h2>Athletes</h2>

<input id="name" placeholder="Name">
<input id="grade" placeholder="Grade">
<input id="photo" type="file">

<button class="primary" onclick="addAthlete()">Add Athlete</button>

<div id="athleteList"></div>
</div>

</div>

<!-- STATS PAGE -->
<div id="statsPage" class="hidden">

<button onclick="backToProfiles()">‚¨Ö Back</button>

<div class="card">
<h2 id="athleteTitle"></h2>

<select id="event">
<option>100m</option>
<option>200m</option>
<option>400m</option>
<option>800m</option>
<option>1600m</option>
</select>

<input id="time" placeholder="Time (sec)">
<button class="primary" onclick="addTime()">Add Result</button>

<canvas id="chart"></canvas>
</div>

<div class="card">
<h3>üèÅ Race Prediction AI</h3>
<input id="predInput" placeholder="Recent time">
<button class="primary" onclick="predict()">Predict</button>
<div id="prediction"></div>
</div>

<div class="card">
<h3>‚è± Split Calculator</h3>
<input id="splitTime" placeholder="Total time">
<input id="splitDistance" placeholder="Distance">
<input id="splitSegment" placeholder="Segment">
<button class="primary" onclick="calcSplit()">Calculate</button>
<div id="splitResult"></div>
</div>

<div class="card">
<h3>üéØ Goals</h3>
<input id="goalInput" placeholder="Goal">
<button class="primary" onclick="addGoal()">Add Goal</button>
<div id="goals"></div>
</div>

</div>

<!-- WORKOUT PAGE -->
<div id="workoutPage" class="hidden">

<button onclick="backToProfiles()">‚¨Ö Back</button>

<div class="card">
<h2>Workout Planner</h2>
<textarea id="workout" rows="6"></textarea>
<button class="primary" onclick="saveWorkout()">Save</button>
</div>

</div>

<!-- SYNC PAGE -->
<div id="syncPage" class="hidden">

<button onclick="backToProfiles()">‚¨Ö Back</button>

<div class="card">
<h2>‚òÅÔ∏è Sync</h2>
<button class="primary" onclick="exportData()">Export Data</button>
<input type="file" onchange="importData(event)">
</div>

</div>

</div>

<script>
let data = JSON.parse(localStorage.getItem("trackPro2")) || {athletes:[]};
let current = null;

function save(){localStorage.setItem("trackPro2",JSON.stringify(data));}

function addAthlete(){
  const file=photo.files[0];
  const athlete={name:name.value,grade:grade.value,photo:"",results:{},goals:[],workout:""};
  
  if(file){
    const r=new FileReader();
    r.onload=()=>{athlete.photo=r.result;finishAdd(athlete);}
    r.readAsDataURL(file);
  } else finishAdd(athlete);
}

function finishAdd(a){
  data.athletes.push(a);
  save();
  renderAthletes();
}

function renderAthletes(){
  athleteList.innerHTML="";
  data.athletes.forEach((a,i)=>{
    athleteList.innerHTML+=`
      <div class="profile" onclick="openAthlete(${i})">
        <img class="avatar" src="${a.photo}">
        <div>
          <b>${a.name}</b><br>
          Grade ${a.grade}
        </div>
      </div>`;
  });
}

function openAthlete(i){
  current=i;
  athleteTitle.innerText=data.athletes[i].name;
  document.getElementById("profilesPage").classList.add("hidden");
  document.getElementById("nav").classList.remove("hidden");
  showPage("stats");
  updateChart();
  renderGoals();
}

function backToProfiles(){
  document.getElementById("profilesPage").classList.remove("hidden");
  document.getElementById("nav").classList.add("hidden");
  hideAll();
}

function showPage(p){
  hideAll();
  document.getElementById(p+"Page").classList.remove("hidden");
}

function hideAll(){
  ["stats","workout","sync"].forEach(p=>{
    document.getElementById(p+"Page").classList.add("hidden");
  });
}

function addTime(){
  const e=event.value;
  const t=parseFloat(time.value);
  const a=data.athletes[current];
  if(!a.results[e]) a.results[e]=[];
  a.results[e].push(t);
  save();
  updateChart();
}

let chart;

function updateChart(){
  const a=data.athletes[current];
  const e=event.value;
  const arr=a.results[e]||[];
  if(chart) chart.destroy();
  chart=new Chart(chart,{
    type:"line",
    data:{labels:arr.map((_,i)=>i+1),datasets:[{data:arr}]},
    options:{plugins:{legend:{display:false}}}
  });
}

function predict(){
  const t=parseFloat(predInput.value);
  prediction.innerText="Predicted PR: "+(t*0.97).toFixed(2)+" sec";
}

function calcSplit(){
  const T=+splitTime.value;
  const D=+splitDistance.value;
  const S=+splitSegment.value;
  splitResult.innerText="Split: "+(T/D*S).toFixed(2)+" sec";
}

function addGoal(){
  const a=data.athletes[current];
  a.goals.push(goalInput.value);
  save();
  renderGoals();
}

function renderGoals(){
  const a=data.athletes[current];
  goals.innerHTML=(a.goals||[]).map(g=>`<div class="goal">${g}</div>`).join("");
}

function saveWorkout(){
  data.athletes[current].workout=workout.value;
  save();
}

function exportData(){
  const blob=new Blob([JSON.stringify(data)],{type:"application/json"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="trackpro.json";
  a.click();
}

function importData(e){
  const r=new FileReader();
  r.onload=()=>{data=JSON.parse(r.result);save();location.reload();}
  r.readAsText(e.target.files[0]);
}

renderAthletes();
</script>

</body>
</html>
