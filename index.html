<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Performance Tracker</title>

<style>
:root{
  --bg:#0a0a0a;
  --card:#121212;
  --accent:#00e676;
  --text:#f5f5f7;
  --muted:#9ca3af;
  --danger:#ff453a;
}

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto;
  background:var(--bg);
  color:var(--text);
}

/* HEADER */

header{
  padding:22px;
  font-size:26px;
  font-weight:700;
  letter-spacing:.5px;
}

/* GRID */

.container{padding:20px;}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(190px,1fr));
  gap:20px;
}

.card{
  background:var(--card);
  border-radius:18px;
  padding:40px 12px;
  text-align:center;
  font-weight:600;
  cursor:pointer;
  transition:.25s;
  position:relative;
  box-shadow:0 10px 25px rgba(0,0,0,.5);
}

.card:hover{
  transform:translateY(-6px) scale(1.03);
  background:#1a1a1a;
}

.card button{
  position:absolute;
  top:10px;
  right:10px;
  background:var(--danger);
  border:none;
  color:white;
  border-radius:50%;
  width:26px;
  height:26px;
  cursor:pointer;
}

.addCard{
  border:2px dashed #333;
  background:#101010;
  font-size:32px;
}

/* PROFILE */

.topbar{
  display:flex;
  gap:10px;
  margin-bottom:15px;
}

button{
  border:none;
  border-radius:12px;
  padding:10px 16px;
  font-weight:600;
  cursor:pointer;
}

.primary{background:var(--accent); color:black;}
.secondary{background:#2a2a2a;}
.danger{background:var(--danger);}

table{
  width:100%;
  border-collapse:collapse;
  background:var(--card);
  border-radius:16px;
  overflow:hidden;
}

th,td{
  padding:12px;
  text-align:center;
}

th{
  background:#1f1f1f;
  color:var(--muted);
  font-weight:600;
}

tr:not(:last-child){
  border-bottom:1px solid #222;
}

input{
  width:100%;
  background:transparent;
  border:none;
  color:white;
  text-align:center;
  font-size:15px;
}

.pr{
  background:var(--accent);
  color:black;
  border-radius:6px;
  font-weight:700;
}

/* BEST PANEL */

.panel{
  margin-top:18px;
  background:var(--card);
  padding:16px;
  border-radius:16px;
  box-shadow:0 10px 20px rgba(0,0,0,.4);
}

.panel h3{
  margin-top:0;
  color:var(--muted);
  font-weight:600;
}
</style>
</head>

<body>

<header>Performance Tracker</header>

<div id="home" class="container"></div>
<div id="profile" class="container" style="display:none;"></div>

<script>
let db = JSON.parse(localStorage.getItem("proPlayersCRM")) || {};
let current=null;

function save(){localStorage.setItem("proPlayersCRM",JSON.stringify(db));}

/* HOME */

function showHome(){
  profile.style.display="none";
  home.style.display="block";

  let html='<div class="grid">';

  Object.keys(db).forEach(name=>{
    html+=`
      <div class="card" onclick="openPlayer('${name}')">
        ${name}
        <button onclick="event.stopPropagation();deletePlayer('${name}')">✕</button>
      </div>`;
  });

  html+=`<div class="card addCard" onclick="newPlayer()">＋</div></div>`;
  home.innerHTML=html;
}

function newPlayer(){
  const name=prompt("Player name?");
  if(!name) return;
  db[name]=[];
  save();
  showHome();
}

function deletePlayer(name){
  if(confirm("Delete "+name+"?")){
    delete db[name];
    save();
    showHome();
  }
}

/* PROFILE */

function openPlayer(name){
  current=name;
  home.style.display="none";
  profile.style.display="block";

  let html=`
    <div class="topbar">
      <button class="secondary" onclick="showHome()">←</button>
      <button class="primary" onclick="addRow()">Add Result</button>
      <button class="secondary" onclick="saveProfile()">Save</button>
      <button class="danger" onclick="clearAll()">Clear</button>
    </div>

    <h2>${name}</h2>

    <table id="tbl">
      <tr>
        <th>Meet</th>
        <th>100</th><th>200</th><th>400</th>
        <th>800</th><th>1600</th>
        <th>LJ</th><th>HJ</th><th>TJ</th>
        <th></th>
      </tr>
    </table>

    <div id="bests" class="panel"></div>
  `;

  profile.innerHTML=html;

  db[name].forEach(addRow);
  updatePR();
}

function addRow(data={}){
  const tbl=document.getElementById("tbl");
  const r=tbl.insertRow();

  const f=["meet","100","200","400","800","1600","lj","hj","tj"];

  f.forEach(x=>{
    const c=r.insertCell();
    c.innerHTML=`<input value="${data[x]||""}" oninput="updatePR()">`;
  });

  const del=r.insertCell();
  del.innerHTML=`<button class="danger" onclick="this.closest('tr').remove();updatePR()">✕</button>`;
}

function saveProfile(){
  const rows=document.querySelectorAll("#tbl tr");
  const data=[];

  rows.forEach((r,i)=>{
    if(i===0) return;
    const x=r.querySelectorAll("input");
    data.push({
      meet:x[0].value,
      100:x[1].value,
      200:x[2].value,
      400:x[3].value,
      800:x[4].value,
      1600:x[5].value,
      lj:x[6].value,
      hj:x[7].value,
      tj:x[8].value
    });
  });

  db[current]=data;
  save();
  alert("Saved");
}

function clearAll(){
  if(confirm("Clear results?")){
    db[current]=[];
    save();
    openPlayer(current);
  }
}

/* PR SYSTEM */

function updatePR(){
  const rows=document.querySelectorAll("#tbl tr");
  const best={1:Infinity,2:Infinity,3:Infinity,4:Infinity,5:Infinity,6:0,7:0,8:0};

  rows.forEach((r,i)=>{
    if(i===0) return;
    const x=r.querySelectorAll("input");

    for(let c=1;c<=5;c++){
      const v=parseFloat(x[c].value);
      if(!isNaN(v)&&v<best[c]) best[c]=v;
    }

    for(let c=6;c<=8;c++){
      const v=parseFloat(x[c].value);
      if(!isNaN(v)&&v>best[c]) best[c]=v;
    }
  });

  rows.forEach((r,i)=>{
    if(i===0) return;
    const x=r.querySelectorAll("input");

    for(let c=1;c<=8;c++){
      x[c].classList.remove("pr");
      const v=parseFloat(x[c].value);
      if(isNaN(v)) continue;

      if((c<=5 && v===best[c]) || (c>=6 && v===best[c]))
        x[c].classList.add("pr");
    }
  });

  document.getElementById("bests").innerHTML=`
    <h3>Personal Bests</h3>
    100: ${best[1]||"-"} | 200: ${best[2]||"-"} | 400: ${best[3]||"-"}<br>
    800: ${best[4]||"-"} | 1600: ${best[5]||"-"}<br>
    LJ: ${best[6]||"-"} | HJ: ${best[7]||"-"} | TJ: ${best[8]||"-"}
  `;
}

showHome();
</script>

</body>
</html>
