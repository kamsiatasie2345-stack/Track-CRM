<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TrackPro Athlete</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:#0b0b0f;
  color:white;
}

.header{
  padding:20px;
  font-size:28px;
  font-weight:700;
  background:linear-gradient(90deg,#ff003c,#ff8c00);
  text-align:center;
}

.container{
  padding:20px;
  max-width:1100px;
  margin:auto;
}

.card{
  background:#15151c;
  padding:18px;
  border-radius:18px;
  margin-bottom:18px;
  box-shadow:0 0 25px rgba(255,0,60,.15);
}

input,select{
  width:100%;
  padding:12px;
  margin:6px 0;
  border-radius:10px;
  border:none;
  background:#0b0b0f;
  color:white;
}

button{
  background:linear-gradient(90deg,#ff003c,#ff8c00);
  border:none;
  padding:12px 16px;
  border-radius:12px;
  font-weight:700;
  cursor:pointer;
  margin-top:8px;
}

.profile{
  display:flex;
  gap:15px;
  align-items:center;
  margin-bottom:10px;
}

.avatar{
  width:70px;
  height:70px;
  border-radius:50%;
  object-fit:cover;
  background:#222;
}

.fireworks{
  position:fixed;
  inset:0;
  pointer-events:none;
}

.goal{
  background:#0b0b0f;
  padding:10px;
  border-radius:10px;
  margin-top:6px;
}
</style>
</head>

<body>

<div class="header">üèÉ TrackPro Athlete</div>

<div class="container">

<!-- PROFILE -->
<div class="card">
<h2>Athlete Profile</h2>

<input id="name" placeholder="Name">
<input id="grade" placeholder="Grade">
<input id="photo" type="file">

<button onclick="saveProfile()">Save Profile</button>

<div id="profileView"></div>
</div>

<!-- TIMES -->
<div class="card">
<h2>Performance</h2>

<select id="event">
<option>100m</option>
<option>200m</option>
<option>400m</option>
<option>800m</option>
<option>1600m</option>
</select>

<input id="time" placeholder="Time (seconds)">
<button onclick="addTime()">Add Result</button>

<canvas id="chart"></canvas>
</div>

<!-- AI PREDICTOR -->
<div class="card">
<h2>üèÅ Race Prediction AI</h2>
<input id="predInput" placeholder="Enter recent time">
<button onclick="predict()">Predict Next PR</button>
<div id="prediction"></div>
</div>

<!-- SPLIT CALCULATOR -->
<div class="card">
<h2>‚è± Split Calculator</h2>
<input id="splitTime" placeholder="Total time">
<input id="splitDistance" placeholder="Distance (m)">
<input id="splitSegment" placeholder="Segment (m)">
<button onclick="calcSplit()">Calculate Split</button>
<div id="splitResult"></div>
</div>

<!-- GOALS -->
<div class="card">
<h2>üéØ Goals</h2>
<input id="goalInput" placeholder="Enter goal">
<button onclick="addGoal()">Add Goal</button>
<div id="goals"></div>
</div>

<!-- WORKOUT -->
<div class="card">
<h2>üèÉ Workout Planner</h2>
<textarea id="workout" rows="4" style="width:100%;background:#0b0b0f;color:white;border:none;border-radius:10px;padding:10px;"></textarea>
<button onclick="saveWorkout()">Save Workout</button>
</div>

<!-- SYNC -->
<div class="card">
<h2>‚òÅÔ∏è Sync</h2>
<button onclick="exportData()">Export Data</button>
<input type="file" onchange="importData(event)">
</div>

</div>

<canvas class="fireworks" id="fx"></canvas>

<script>
let data = JSON.parse(localStorage.getItem("trackPro")) || {
  profile:{},
  results:{},
  goals:[],
  workout:""
};

function saveAll(){
  localStorage.setItem("trackPro",JSON.stringify(data));
}

function saveProfile(){
  const file=document.getElementById("photo").files[0];
  if(file){
    const reader=new FileReader();
    reader.onload=()=>{
      data.profile.photo=reader.result;
      finishProfile();
    };
    reader.readAsDataURL(file);
  } else finishProfile();
}

function finishProfile(){
  data.profile.name=name.value;
  data.profile.grade=grade.value;
  saveAll();
  renderProfile();
}

function renderProfile(){
  if(!data.profile.name) return;
  profileView.innerHTML=`
    <div class="profile">
      <img class="avatar" src="${data.profile.photo||''}">
      <div>
        <b>${data.profile.name}</b><br>
        Grade ${data.profile.grade}
      </div>
    </div>
  `;
}

function addTime(){
  const e=event.value;
  const t=parseFloat(time.value);
  if(!data.results[e]) data.results[e]=[];
  const best=Math.min(...(data.results[e].length?data.results[e]:[9999]));
  data.results[e].push(t);
  saveAll();
  updateChart();

  if(t<best) fireworks();
}

let chart;

function updateChart(){
  const e=event.value;
  const arr=data.results[e]||[];
  if(chart) chart.destroy();
  chart=new Chart(chart,{
    type:"line",
    data:{labels:arr.map((_,i)=>i+1),datasets:[{data:arr}]},
    options:{plugins:{legend:{display:false}}}
  });
}

function predict(){
  const t=parseFloat(predInput.value);
  const predicted=(t*0.97).toFixed(2);
  prediction.innerText="Predicted PR: "+predicted+" sec";
}

function calcSplit(){
  const T=+splitTime.value;
  const D=+splitDistance.value;
  const S=+splitSegment.value;
  splitResult.innerText="Split: "+(T/D*S).toFixed(2)+" sec";
}

function addGoal(){
  data.goals.push(goalInput.value);
  saveAll();
  renderGoals();
}

function renderGoals(){
  goals.innerHTML=data.goals.map(g=>`<div class="goal">${g}</div>`).join("");
}

function saveWorkout(){
  data.workout=workout.value;
  saveAll();
}

function exportData(){
  const blob=new Blob([JSON.stringify(data)],{type:"application/json"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="trackpro.json";
  a.click();
}

function importData(e){
  const file=e.target.files[0];
  const reader=new FileReader();
  reader.onload=()=>{
    data=JSON.parse(reader.result);
    saveAll();
    location.reload();
  };
  reader.readAsText(file);
}

function fireworks(){
  const c=fx;
  const ctx=c.getContext("2d");
  c.width=innerWidth;
  c.height=innerHeight;

  let particles=[];
  for(let i=0;i<150;i++){
    particles.push({
      x:c.width/2,
      y:c.height/2,
      vx:(Math.random()-0.5)*10,
      vy:(Math.random()-0.5)*10,
      life:60
    });
  }

  function loop(){
    ctx.clearRect(0,0,c.width,c.height);
    particles.forEach(p=>{
      p.x+=p.vx;
      p.y+=p.vy;
      p.life--;
      ctx.fillStyle="hsl("+Math.random()*360+",100%,60%)";
      ctx.fillRect(p.x,p.y,3,3);
    });
    particles=particles.filter(p=>p.life>0);
    if(particles.length) requestAnimationFrame(loop);
  }
  loop();
}

renderProfile();
renderGoals();
updateChart();
</script>

</body>
</html>
